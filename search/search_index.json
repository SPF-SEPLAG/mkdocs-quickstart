{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"N\u00facleo Automa\u00e7\u00e3o SPF","text":"<p>Bem-vindo \u00e0 documenta\u00e7\u00e3o central de todos os projetos de automa\u00e7\u00e3o da SPF. Clique em um dos cards abaixo para come\u00e7ar:</p> <ul> <li>\ud83d\udcc4 Documenta\u00e7\u00f5es   Acesse guias e manuais de refer\u00eancia.  </li> </ul> <p>&gt; Ir para Documenta\u00e7\u00f5es</p> <ul> <li>\ud83d\udcc1 Projetos   Veja detalhes e progresso dos projetos.  </li> </ul> <p>&gt; Ir para Projetos</p> <ul> <li>\ud83d\udc65 Quem Somos   Conhe\u00e7a o time por tr\u00e1s das automa\u00e7\u00f5es.  </li> </ul> <p>&gt; Ir para Quem Somos</p>"},{"location":"automate_desktop/","title":"Documenta\u00e7\u00f5es Power Automate","text":""},{"location":"automate_desktop/#documentacao-fluxo-liquidacao","title":"Documenta\u00e7\u00e3o Fluxo Liquida\u00e7\u00e3o","text":""},{"location":"automate_desktop/#documentacao-fluxo-notas-fiscais","title":"Documenta\u00e7\u00e3o Fluxo Notas Fiscais","text":""},{"location":"automate_desktop/#documentacao-fluxo-issqn","title":"Documenta\u00e7\u00e3o Fluxo ISSQN","text":""},{"location":"automate_desktop/#documentacao-fluxo-ordens-de-pagamento-sede","title":"Documenta\u00e7\u00e3o Fluxo Ordens de Pagamento - SEDE","text":""},{"location":"automate_issqn/","title":"Fluxo Power Automate \u2013 ISSQN","text":""},{"location":"automate_issqn/#objetivo","title":"Objetivo","text":"<p>Este fluxo automatiza a emiss\u00e3o das guias de ISSQN, a inser\u00e7\u00e3o de guias de ISSQN no SEI e o registro de servi\u00e7os tomados.</p>"},{"location":"automate_issqn/#documentacao","title":"Documenta\u00e7\u00e3o","text":"<p>O fluxo \u00e9 composto por 1 fluxo principal (Main) e 6 subfluxos (Inicializa Fluxo, Registrar Servi\u00e7o, Emitir Guia, Inserir Guia no SEI, Inserir Valor NF, Registrar Servi\u00e7o Tomado).</p> <ol> <li>O fluxo principal (Main) inicia definindo a vari\u00e1vel <code>ListaProcessos</code> e, conforme escolha do usu\u00e1rio, chama o subfluxo Registrar Servi\u00e7o ou o subfluxo Emitir Guia.</li> <li>Caso o usu\u00e1rio escolha executar o subfluxo Registrar Servi\u00e7o, ser\u00e3o chamados dois subfluxos: Inicializa Fluxo e Registrar Servi\u00e7o Tomado.</li> <li>Caso o usu\u00e1rio escolha executar o subfluxo Emitir Guia, ser\u00e3o chamados dois subfluxos: Inicializa Fluxo e Emitir Guia.</li> <li>Para realizar o registro de servi\u00e7os, o fluxo segue o seguinte passo a passo:</li> <li>Executa o subfluxo Inicializa Fluxo.</li> <li>O subfluxo Inicializa Fluxo define as vari\u00e1veis de fluxo, recebendo o caminho da pasta \u201cDocumentos\u201d.</li> <li>Inicia o Excel na planilha auxiliar e armazena a inst\u00e2ncia na vari\u00e1vel <code>Planilha</code>.</li> <li>Obt\u00e9m a primeira coluna e primeira linha livre, armazenando em <code>ColunaLivre</code> e <code>LinhaLivre</code>.</li> <li>L\u00ea todo o intervalo de dados preenchidos na planilha.</li> <li>Fecha o Excel e coloca em foco a janela da DES.</li> <li>Executa o subfluxo Registrar Servi\u00e7o Tomado, que funciona como um loop, iterando cada linha na vari\u00e1vel <code>DadosPlanilha</code>.</li> <li>Chama o subfluxo Inicializa Loop, onde s\u00e3o inicializadas as vari\u00e1veis com os dados de cada linha.</li> <li>Define a vari\u00e1vel <code>DataEmissaoOP</code> com o valor do campo \u201cData de emiss\u00e3o OP\u201d da cole\u00e7\u00e3o <code>DadosPlanilha</code>, convertendo-o para Data.</li> <li>Valida se o credor \u00e9 MGS ou PRODEMGE e prossegue apenas nesses casos.</li> <li>Envia as informa\u00e7\u00f5es de emiss\u00e3o, processo SEI, credor e demais campos exigidos.</li> <li>Ap\u00f3s criar o fluxo seguindo os passos indicados, utilize os arquivos <code>Main.txt</code>, <code>Inicializar vari\u00e1veis de fluxo.txt</code>, <code>Emitir Guia.txt</code> e <code>Registrar Servi\u00e7o Tomado.txt</code> para copi\u00e1-los e col\u00e1-los no Power Automate, criando os subfluxos correspondentes.</li> <li>Para o fluxo ser executado, crie uma planilha auxiliar (<code>dados.xlsx</code>) no caminho <code>%FilePathFluxo%\\\\dados.xlsx</code>.</li> <li>A planilha auxiliar deve conter as seguintes colunas:    (defina as colunas conforme o layout de entrada dos dados)</li> <li>Para utilizar o fluxo, \u00e9 necess\u00e1rio ter o terminal da DES instalado. A instala\u00e7\u00e3o pode ser solicitada ao setor de T.I.</li> <li>Ap\u00f3s o terminal da DES estar instalado, realize o login no sistema.</li> <li>Com o ambiente preparado, a DES deve permanecer na tela inicial ap\u00f3s o login.</li> <li>Em seguida, execute normalmente o fluxo.</li> </ol>"},{"location":"automate_issqn/#passos-para-execucao-do-fluxo-no-power-automate-desktop","title":"Passos Para Execu\u00e7\u00e3o do Fluxo no Power Automate Desktop","text":"<p>Caso j\u00e1 tenha o ambiente preparado (Power Automate instalado, fluxo criado e terminal da DES instalado), pode pular para o passo 6. Caso j\u00e1 tenha o Power Automate instalado e o fluxo criado, pode pular para o passo 5. Caso n\u00e3o tenha o ambiente preparado, siga desde o primeiro passo.</p> <ol> <li>Fazer download do Power Automate Desktop no site da Microsoft.  </li> <li>Instalar e realizar login com sua conta corporativa (CAMG).  </li> <li>Criar novo fluxo (caso n\u00e3o exista):  </li> <li>Criar fluxo  </li> <li>Nomear fluxo  </li> <li>Criar subfluxos  </li> <li>Copiar e colar os arquivos <code>Main.txt</code>, <code>Inicializar vari\u00e1veis de fluxo.txt</code>, <code>Emitir Guia.txt</code> e <code>Registrar Servi\u00e7o Tomado.txt</code> nos subfluxos correspondentes.  </li> <li>Criar a planilha auxiliar (<code>dados.xlsx</code>) com as colunas necess\u00e1rias e definir seu caminho na vari\u00e1vel <code>FilePathFluxo</code>.  </li> <li>Executar o fluxo.  </li> </ol>"},{"location":"automate_liquidacao/","title":"Fluxo Power Automate \u2013 Liquida\u00e7\u00e3o","text":""},{"location":"automate_liquidacao/#objetivo","title":"Objetivo","text":"<p>Este fluxo automatiza a liquida\u00e7\u00e3o, registrando no sistema SIAFI os dados das notas fiscais a serem liquidadas.</p>"},{"location":"automate_liquidacao/#documentacao","title":"Documenta\u00e7\u00e3o","text":"<p>O fluxo \u00e9 composto por um fluxo principal (Main) e tr\u00eas subfluxos: Inicializar Vari\u00e1veis de Fluxo, Executar Siafi Terminal e Siafi Web.</p> <ol> <li>O fluxo principal (Main) inicializa as vari\u00e1veis chamando o subfluxo Inicializar Vari\u00e1veis.</li> <li>Ap\u00f3s a inicializa\u00e7\u00e3o, o fluxo define a vari\u00e1vel <code>FilePath</code>, que armazena o caminho da planilha auxiliar (<code>dados.xlsx</code>) localizada no diret\u00f3rio especificado. Esse arquivo cont\u00e9m os dados necess\u00e1rios para o processo de liquida\u00e7\u00e3o no SIAFI.</li> <li>Ap\u00f3s acessar a planilha auxiliar, o fluxo define quatro vari\u00e1veis essenciais para o processo:</li> <li>Minot: armazena a janela em inst\u00e2ncia do SIAFI aberta.</li> <li>CnpjInss: cont\u00e9m o CNPJ do INSS.</li> <li>Uo: guarda o n\u00famero da unidade or\u00e7ament\u00e1ria (padr\u00e3o: 1501).</li> <li>RowIndex: armazena o valor <code>1</code>, utilizada para navega\u00e7\u00e3o na planilha.</li> <li>Ap\u00f3s a defini\u00e7\u00e3o das vari\u00e1veis, o fluxo inicia o Excel usando <code>FilePath</code> e obt\u00e9m a primeira coluna e linha livre, armazenando-as nas vari\u00e1veis <code>ColunaLivre</code> e <code>LinhaLivre</code>.</li> <li>O fluxo l\u00ea os dados da planilha do intervalo <code>A1</code> at\u00e9 a \u00faltima c\u00e9lula n\u00e3o vazia, armazenando-os em <code>DadosLiquidacao</code>.</li> <li>O fluxo itera sobre cada linha em <code>DadosLiquidacao</code> (loop for each), armazenando a linha atual em <code>Linha</code>.</li> <li>Para cada <code>Linha</code>, o fluxo envia os dados para o SIAFI (inst\u00e2ncia <code>Minot</code>), navegando no sistema.</li> <li>Condi\u00e7\u00f5es IF:</li> <li>Se <code>Linha[\"Conformidade\"]</code> \u2260 <code>N/A</code>, lan\u00e7a o valor; caso contr\u00e1rio, pula com TAB.</li> <li>Verifica se <code>Linha[\"Valor INSS\"]</code> e <code>Linha[\"Valor ISSQN\"]</code> est\u00e3o vazias:</li> <li>Se vazias: preenche com <code>s</code>; sen\u00e3o: preenche com <code>n</code>.</li> <li>Obt\u00e9m a data atual (<code>DataAtual</code>) e formata como m\u00eas de compet\u00eancia.</li> <li>Converte o valor da NF em texto sem separador decimal.</li> <li>Define <code>Ordenador</code> com o valor de <code>Linha[\"MASP\"]</code>.</li> <li>Remove d\u00edgito final de <code>MASP</code> se iniciar com <code>m</code> e envia para o SIAFI.</li> <li>Se <code>Valor INSS</code> n\u00e3o est\u00e1 vazio, formata e armazena em <code>ValorInss</code> e <code>CompetenciaInss</code>.</li> <li>Verifica <code>Valor ISSQN</code>: se n\u00e3o vazio, formata e armazena em <code>ValorIssqn</code>. Valida CNPJ Munic\u00edpio, interrompendo com erro se ausente ou tratando e armazenando em <code>CnpjIssqn</code>.</li> <li>L\u00f3gica composta:<ul> <li>Ambos INSS e ISSQN: envia <code>CnpjInss</code>, <code>CompetenciaInss</code>, <code>ValorInss</code>, <code>ValorIssqn</code>.</li> <li>Apenas ISSQN: envia <code>CnpjIssqn</code>, <code>ValorIssqn</code>.</li> <li>Apenas INSS: envia <code>CnpjInss</code>, <code>CompetenciaInss</code>, <code>ValorInss</code>.</li> </ul> </li> <li>Lan\u00e7a <code>Nome Credor</code>, <code>N\u00famero Nota Fiscal</code>, <code>ID</code> e <code>Processo SEI</code>, removendo barras <code>/</code> se presentes.</li> <li>Formata <code>Processo SEI</code>, removendo <code>/</code> e envia.</li> <li>Envia F5 para realizar liquida\u00e7\u00e3o.</li> <li>Copia o conte\u00fado da tela (Ctrl + A, Ctrl + C) para <code>SeqLiquidacao</code>, processa com Python e atualiza.</li> <li>Reabre a planilha e grava <code>SeqLiquidacao</code> na coluna <code>U</code>, usando <code>RowIndex</code>.</li> <li>Envia F3 tr\u00eas vezes para retornar ao in\u00edcio.</li> <li>Ap\u00f3s concluir as etapas no terminal do SIAFI, o fluxo inicia as etapas do SIAFI Web.</li> <li>Abre a planilha auxiliar (<code>FilePath</code>) no Power Automate.</li> <li>L\u00ea os dados em <code>DadosLiquidacao</code> novamente.</li> <li>Itera sobre cada linha em <code>DadosLiquidacao</code>.</li> <li>Abre o Google Chrome e acessa o portal SIAFI Web (inst\u00e2ncia <code>SiafiBranco</code>).</li> <li>Procura pelo texto \"Login Certifica\u00e7\u00e3o Digital\" e navega at\u00e9 os campos de login.</li> <li>Preenche as credenciais com <code>UsuarioSiafi</code> e <code>SenhaSiafi</code>.</li> <li>Clica em \"Consulta / Impress\u00e3o Documento Espec\u00edfico\".</li> <li>Executa JavaScript para selecionar a Unidade Executora (elemento \"UE\").</li> <li>Navega com TAB e Down para preencher No.Empenho e Seq.Liquida\u00e7\u00e3o.</li> <li>Pressiona Ctrl + S para salvar o relat\u00f3rio (<code>GeraRelatorioEmpenhoServlet</code>).</li> <li>Na janela de di\u00e1logo, define o caminho usando <code>FilePath + \"\\\\liquida\u00e7\u00e3o.pdf\"</code> e confirma com Enter.</li> <li>Fecha as janelas do SIAFI Web e do gerador de relat\u00f3rios.</li> <li>Abre nova inst\u00e2ncia do Chrome e acessa o portal SEI (vari\u00e1vel <code>Sei</code>).</li> <li>Faz login no SEI com <code>SeiSenha</code>.</li> <li>Clica na barra de pesquisa e busca <code>Processo SEI</code> (valor em <code>Linha</code>).</li> <li>Pressiona Enter para localizar o processo.</li> <li>Clica em \"Incluir Documento\".</li> <li>Seleciona \"Externo\", preenche dados (DataAtual, N\u00ba Empenho, Seq. Liquida\u00e7\u00e3o, Id) e realiza upload.</li> <li>Exclui o arquivo local ap\u00f3s inser\u00e7\u00e3o no SEI.</li> </ol>"},{"location":"automate_liquidacao/#passos-para-execucao-do-fluxo-no-power-automate-desktop","title":"Passos Para Execu\u00e7\u00e3o do Fluxo no Power Automate Desktop","text":"<p>Pr\u00e9-requisitos - Power Automate Desktop instalado - Fluxo criado - Planilha auxiliar (<code>dados.xlsx</code>) configurada na vari\u00e1vel <code>FilePath</code> - Siafi Terminal instalado  </p> <p>Fluxo de execu\u00e7\u00e3o 1. Fazer download do Power Automate Desktop (site da Microsoft). 2. Instalar e fazer login com conta corporativa (CAMG). 3. Criar novo fluxo (caso n\u00e3o exista):    - Criar fluxo    - Nomear fluxo    - Criar subfluxos 4. Colar os arquivos <code>Main.txt</code>, <code>Inicializar vari\u00e1veis de Fluxo.txt</code>, <code>Executar Siafi Terminal.txt</code> e <code>Executar Siafi Web.txt</code> nos subfluxos correspondentes. 5. Criar a planilha auxiliar com as colunas necess\u00e1rias e definir seu caminho em <code>FilePath</code>. 6. Executar fluxo. '''</p>"},{"location":"automate_nfs/","title":"Documenta\u00e7\u00e3o Fluxo Pagamento Notas Fiscais","text":""},{"location":"automate_nfs/#objetivo","title":"Objetivo","text":"<p>Este fluxo automatiza a leitura de notas fiscais (NFs) dentro de uma estrutura de pastas, percorrendo subpastas organizadas por unidades e processos. O objetivo \u00e9 garantir que apenas as unidades MGS e PRODEMGE sejam processadas.</p>"},{"location":"automate_nfs/#documentacao","title":"Documenta\u00e7\u00e3o","text":"<p>O fluxo \u00e9 composto por um fluxo principal (Main) e dois subfluxos (Inicializar Vari\u00e1veis de Fluxo e Ler NFs).</p> <ol> <li>O fluxo principal (Main) inicializa as vari\u00e1veis chamando o subfluxo Inicializar Vari\u00e1veis de Fluxo.</li> <li>Ap\u00f3s a inicializa\u00e7\u00e3o, ele obt\u00e9m as subpastas dentro do diret\u00f3rio definido na vari\u00e1vel FilePath. Essa vari\u00e1vel cont\u00e9m o caminho onde os documentos a serem analisados est\u00e3o armazenados. As subpastas encontradas s\u00e3o armazenadas na vari\u00e1vel Unidades.</li> <li>O fluxo ent\u00e3o itera sobre cada subpasta armazenada na vari\u00e1vel Unidades. Dentro de cada subpasta, ele obt\u00e9m os processos existentes e os armazena na vari\u00e1vel Processos.</li> <li>Para cada Processo dentro de uma Unidade, o fluxo chama o subfluxo Ler NFs, respons\u00e1vel por realizar a leitura das notas fiscais.</li> <li>Ap\u00f3s a execu\u00e7\u00e3o do subfluxo Ler NFs, s\u00e3o definidas vari\u00e1veis contendo as informa\u00e7\u00f5es extra\u00eddas das notas fiscais, tais como:</li> <li>Processo SEI</li> <li>Doc.SeiNF</li> <li>Doc.SeiAteste</li> <li>Doc.SeiConformidade</li> <li>DtVencimento</li> <li>InicioCompetencia</li> <li>FimCompetencia</li> <li>ValorNF</li> <li>Banco (valor fixo)</li> <li>Ag\u00eancia (valor fixo)</li> <li>Conta (valor fixo)</li> </ol> <p>As vari\u00e1veis Banco, Ag\u00eancia e Conta possuem valores fixos, enquanto as demais s\u00e3o extra\u00eddas com base em delimitadores de texto das notas fiscais. 6. Ap\u00f3s a extra\u00e7\u00e3o dos dados, o fluxo se anexa a uma aba aberta no navegador, onde a planilha CONTROLE DCF 2024.xlsx deve estar carregada na aba Notas Fiscais. 7. O fluxo exibe uma mensagem solicitando ao usu\u00e1rio que selecione a primeira c\u00e9lula vazia da planilha antes de continuar. Ap\u00f3s essa sele\u00e7\u00e3o, ele utiliza a fun\u00e7\u00e3o Enviar Teclas para colar os valores extra\u00eddos diretamente na planilha do Excel.</p>"},{"location":"automate_nfs/#passos-para-execucao-do-fluxo-no-power-automate-desktop","title":"Passos Para Execu\u00e7\u00e3o do Fluxo no Power Automate Desktop","text":"<p>Caso j\u00e1 tenha o ambiente preparado (Power Automate instalado, fluxo criado e estrutura de pastas criada), pode-se passar para o passo 7.</p> <p>Caso j\u00e1 tenha o ambiente preparado (Power Automate instalado e fluxo criado), pode-se passar para o passo 6.</p> <p>Caso n\u00e3o tenha o ambiente preparado, seguir desde o primeiro passo.</p> <ol> <li>Fazer download da ferramenta no site da Microsoft (caso n\u00e3o tenha).</li> <li>Ap\u00f3s o download da ferramenta, realizar a instala\u00e7\u00e3o.</li> <li>Ap\u00f3s a instala\u00e7\u00e3o, a ferramenta solicitar\u00e1 que fa\u00e7a login com a sua conta corporativa (conta da pr\u00f3pria CAMG).</li> <li>Ap\u00f3s a instala\u00e7\u00e3o e o login, caso o fluxo n\u00e3o esteja dispon\u00edvel em sua ferramenta, ser\u00e1 necess\u00e1rio cri\u00e1-lo. Para isso, siga os passos abaixo:</li> <li>Criar Novo Fluxo</li> <li>Nomear Novo Fluxo</li> <li>Criar Subfluxos</li> <li>Ap\u00f3s criar o fluxo seguindo os passos indicados, voc\u00ea pode utilizar os arquivos Main.txt, Inicializar vari\u00e1veis de fluxo.txt e Ler NFs.txt, para copi\u00e1-los e col\u00e1-los no Power Automate, criando os respectivos subfluxos.</li> <li>Ap\u00f3s a cria\u00e7\u00e3o do fluxo, \u00e9 necess\u00e1rio configurar a estrutura de pastas e subpastas para a leitura das notas fiscais. Para isso, acesse o diret\u00f3rio \u201cDocumentos\u201d no seu computador e siga estas etapas:</li> <li>Crie a pasta raiz onde as subpastas das unidades e processos ser\u00e3o armazenadas. Exemplo: Registrar NFs.</li> <li>Dentro dela, crie as subpastas: MGS e PRODEMGE.</li> <li>Armazene o caminho da pasta raiz na vari\u00e1vel FilePath.</li> <li>Ap\u00f3s as subpastas serem criadas, ser\u00e1 necess\u00e1rio fazer o download e descompacta\u00e7\u00e3o dos processos do SEI onde est\u00e3o as notas fiscais. Basta seguir os passos abaixo:</li> <li>Fazer Login no SEI</li> <li>Pesquisar Processo no SEI</li> <li>Selecionar arquivo ZIP</li> <li>Abrir tela de pesquisa de documentos</li> <li>Escolher quais documentos estar\u00e3o na pasta zipada: esses documentos ser\u00e3o as Notas Fiscais a serem extra\u00eddas, o documento de Ateste de Nota Fiscal e os Dados para Conformidade do m\u00eas corrente.</li> <li>Gerar arquivo ZIP</li> <li>Descompactar pasta zipada para subpasta referente a cada empresa</li> <li>Agora, basta abrir a planilha CONTROLE DCF 2024.xlsx na aba Notas Fiscais (o fluxo est\u00e1 estruturado para que ela esteja aberta no navegador Microsoft Edge) e executar o fluxo.</li> <li>Quando o fluxo iniciar sua execu\u00e7\u00e3o, ele exibir\u00e1 uma mensagem solicitando ao usu\u00e1rio que selecione a primeira linha vazia da planilha e pressione OK para que o fluxo realize a extra\u00e7\u00e3o das notas e o preenchimento na planilha. '''</li> </ol>"},{"location":"automate_sede/","title":"Fluxo Extra\u00e7\u00e3o de Ordens de Pagamento","text":""},{"location":"automate_sede/#objetivo","title":"Objetivo","text":"<p>Este fluxo foi desenvolvido para uma demanda pontual da SEDE, onde deveriam ser extra\u00eddas cerca de 4400 ordens de pagamento referentes aos anos de 2018 a 2020.</p>"},{"location":"automate_sede/#documentacao","title":"Documenta\u00e7\u00e3o","text":"<p>O fluxo \u00e9 composto por um fluxo principal (Main) e dois subfluxos:</p> <ul> <li>Inicializar Vari\u00e1veis de Fluxo: define as vari\u00e1veis utilizadas ao longo do processo.  </li> <li>Navegador: cont\u00e9m as a\u00e7\u00f5es realizadas no portal do SIAFI.</li> </ul>"},{"location":"automate_sede/#variaveis-definidas-em-inicializar-variaveis-de-fluxo","title":"Vari\u00e1veis definidas em Inicializar Vari\u00e1veis de Fluxo","text":"<ul> <li><code>Ano</code>: valor inicial 2018, correspondente \u00e0 primeira aba da planilha e tamb\u00e9m usado para login no SIAFI.  </li> <li><code>Pasta</code>: caminho do diret\u00f3rio onde as ordens de pagamento extra\u00eddas ser\u00e3o salvas.  </li> <li><code>PrimeiraLinha</code>: n\u00famero da primeira linha da planilha a partir da qual os dados ser\u00e3o lidos.  </li> <li><code>LoginSIAFI</code>: usu\u00e1rio para login no SIAFI.  </li> <li><code>SenhaSIAFI</code>: senha para login no SIAFI.  </li> <li><code>UnidadeExecutoraSIAFI</code>: unidade executora usada no login do SIAFI.</li> </ul>"},{"location":"automate_sede/#fluxo-principal-main","title":"Fluxo Principal (Main)","text":"<ol> <li>Chama o subfluxo Inicializar Vari\u00e1veis de Fluxo.  </li> <li>Inicia o loop LoopAbas, que percorre as abas de 2018 a 2020 na planilha:  </li> <li>Atualiza a aba ativa usando a vari\u00e1vel <code>Ano</code>.  </li> <li>Executa o subfluxo Navegador.  </li> <li>Obt\u00e9m a primeira linha vazia da coluna G (ordens de pagamento) e armazena em <code>PrimeiraLinhaVazia</code>.  </li> <li>Inicia o loop LoopDownload, que percorre as linhas da planilha de <code>PrimeiraLinha</code> at\u00e9 <code>PrimeiraLinhaVazia \u2013 1</code>:  </li> <li>L\u00ea o valor da coluna G na linha atual e armazena em <code>OrdemPagamento</code>.  </li> <li>Se <code>OrdemPagamento</code> estiver vazia, sai para o LoopAbas (pr\u00f3xima aba).  </li> <li>Define <code>NomeArquivo</code> igual a <code>OrdemPagamento</code>.  </li> <li>No portal SIAFI, preenche o campo de pesquisa com <code>OrdemPagamento</code> e clica em \u201cConfirmar\u201d.  </li> <li>Captura a janela do documento baixado e armazena em <code>JanelaDOC</code>.  </li> <li>Aguarda 2 segundos para carregar, envia TAB 8 vezes e ENTER para iniciar o download.  </li> <li>Aguarda 2 segundos e envia o caminho de destino: <code>%Pasta%\\{Ano}\\{OrdemPagamento}</code>.  </li> <li>Fecha a janela do documento, volta ao portal e aguarda 5 segundos.  </li> <li>Incrementa <code>PrimeiraLinha</code> em 1.  </li> <li>Ap\u00f3s finalizar o LoopDownload, clica em \u201cVoltar\u201d e em \u201cSair\u201d para encerrar a sess\u00e3o.  </li> <li>Incrementa <code>Ano</code> em 1 e repete at\u00e9 2020.  </li> </ol>"},{"location":"automate_sede/#passos-para-execucao-no-power-automate-desktop","title":"Passos para Execu\u00e7\u00e3o no Power Automate Desktop","text":"<p>Caso j\u00e1 tenha o ambiente preparado (Power Automate instalado, fluxo criado e estrutura de pastas): - Pule para o passo 7. Caso j\u00e1 tenha Power Automate instalado e fluxo criado: - Pule para o passo 6. Caso n\u00e3o tenha o ambiente preparado: - Siga desde o passo 1.</p> <ol> <li>Fa\u00e7a o download do Power Automate Desktop no site da Microsoft.  </li> <li>Instale e fa\u00e7a login com sua conta corporativa (CAMG).  </li> <li>Se necess\u00e1rio, crie um novo fluxo:  </li> <li>Criar fluxo  </li> <li>Nomear fluxo  </li> <li>Criar subfluxos  </li> <li>Copie e cole os arquivos <code>Main.txt</code>, <code>Inicializar vari\u00e1veis de fluxo.txt</code> e <code>Navegador.txt</code> nos subfluxos correspondentes.  </li> <li>Crie a estrutura de pastas:  </li> <li>Pasta raiz: Ordens de Pagamento </li> <li>Subpastas: 2018, 2019 e 2020 </li> <li>Defina as vari\u00e1veis no Power Automate Desktop:  </li> <li><code>Pasta</code>: caminho da pasta raiz  </li> <li><code>PlanilhaExcel</code>: caminho do arquivo Excel com dados  </li> <li>Execute o fluxo.</li> </ol>"},{"location":"documentacoes/","title":"Documenta\u00e7\u00f5es Dispon\u00edveis","text":""},{"location":"documentacoes/#documentacoes-power-automate-desktop","title":"Documenta\u00e7\u00f5es Power Automate Desktop","text":"<pre><code> - Documenta\u00e7\u00e3o de fluxos automatizados pelo n\u00facleo de automa\u00e7\u00e3o SPF utilizando a ferramenta Microsoft Power Automate Desktop.\n</code></pre>"},{"location":"documentacoes/#documentacoes-power-automate-web","title":"Documenta\u00e7\u00f5es Power Automate Web","text":"<pre><code> - Documenta\u00e7\u00e3o de fluxos automatizados pelo n\u00facleo de automa\u00e7\u00e3o SPF utilizando a ferramenta Microsoft Power Automate Web.\n</code></pre>"},{"location":"documentacoes/#documentacoes-python","title":"Documenta\u00e7\u00f5es Python","text":"<pre><code>- Documenta\u00e7\u00e3o de fluxos automatizados em python pelo n\u00facleo de automa\u00e7\u00e3o SPF.\n</code></pre>"},{"location":"documentacoes/#documentacoes-power-bi","title":"Documenta\u00e7\u00f5es Power BI","text":"<pre><code> - Documenta\u00e7\u00e3o de pain\u00e9is criados pelo n\u00facleo de automa\u00e7\u00e3o SPF utilizando a ferramenta Microsoft Power BI.\n</code></pre>"},{"location":"documentacoes/#documentacoes-sistemas","title":"Documenta\u00e7\u00f5es Sistemas","text":"<pre><code> - Documenta\u00e7\u00e3o dos sistemas criados pelo n\u00facleo de automa\u00e7\u00e3o SPF.\n</code></pre>"},{"location":"pbi/","title":"Documenta\u00e7\u00f5es Power BI","text":""},{"location":"pbi/#documentacao-painel-execucao-orcamentaria-dpo","title":"Documenta\u00e7\u00e3o Painel Execu\u00e7\u00e3o Or\u00e7ament\u00e1ria - DPO","text":""},{"location":"pbi/#documentacao-painel-contratos-dccc","title":"Documenta\u00e7\u00e3o Painel Contratos - DCCC","text":""},{"location":"pbi/#documentacao-painel-pac-2025-dccc","title":"Documenta\u00e7\u00e3o Painel PAC 2025 - DCCC","text":""},{"location":"projetos/","title":"Projetos","text":""},{"location":"projetos/#painel-execucao-orcamentaria-dpo","title":"Painel Execu\u00e7\u00e3o Or\u00e7ament\u00e1ria - DPO","text":""},{"location":"projetos/#painel-contratos-dcc","title":"Painel Contratos - DCC","text":""},{"location":"projetos/#painel-pac-2025-dccc","title":"Painel PAC 2025 - DCCC","text":""},{"location":"projetos/#fluxo-pagamento-notas-fiscais","title":"Fluxo Pagamento Notas Fiscais","text":""},{"location":"projetos/#fluxo-liquidacao","title":"Fluxo Liquida\u00e7\u00e3o","text":""},{"location":"projetos/#fluxo-registro-de-empenho","title":"Fluxo Registro de Empenho","text":""},{"location":"projetos/#fluxo-emissao-guia-issqn","title":"Fluxo Emiss\u00e3o Guia ISSQN","text":""},{"location":"projetos/#fluxo-extracao-ordens-de-pagamento-sede","title":"Fluxo Extra\u00e7\u00e3o Ordens de Pagamento SEDE","text":""},{"location":"quem_somos/","title":"N\u00facleo Automa\u00e7\u00e3o SPF","text":""},{"location":"quem_somos/#o-nucleo-de-automacao-da-spf-esta-localizado-na-assessoria-da-superintendencia-e-e-responsavel-pela-automatizacao-de-fluxos-desenvolvimento-de-sistemas-e-dashboards-na-spf","title":"O n\u00facleo de automa\u00e7\u00e3o da SPF est\u00e1 localizado na assessoria da superintend\u00eancia e \u00e9 respons\u00e1vel pela automatiza\u00e7\u00e3o de fluxos, desenvolvimento de sistemas e dashboards na SPF.","text":""},{"location":"quem_somos/#participantes","title":"Participantes","text":""},{"location":"quem_somos/#antonio-marcel-sotero-dias-de-oliveira","title":"Ant\u00f4nio Marcel Sotero Dias de Oliveira","text":""},{"location":"quem_somos/#luiz-felipe-duval-da-cruz","title":"Luiz Felipe Duval da Cruz","text":""}]}